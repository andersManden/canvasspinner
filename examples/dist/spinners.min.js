function CircleSpinner(t){function n(t){e(t),a(t),o(t),l(),r()}function e(t){var n=document.getElementById(t.setup.containerId);d=document.getElementById(t.setup.canvasId),u=d.getContext("2d"),i(n)}function i(t){var n=window.devicePixelRatio||1,e=u.webkitBackingStorePixelRatio||u.mozBackingStorePixelRatio||u.msBackingStorePixelRatio||u.oBackingStorePixelRatio||u.backingStorePixelRatio||1;F=n/e,h=d.width=t.offsetWidth*F,p=d.height=t.offsetHeight*F,d.style.width=h/F+"px",d.style.height=p/F+"px"}function a(t){g=t.options.radius?t.options.radius:20,O=t.options.direction?t.options.direction:"right",C=t.options.color?t.options.color:"#4b4b4b",w=t.options.opacity?t.options.opacity:1}function o(t){f=t.advancedOptions.angleA?t.advancedOptions.angleA:0,v=t.advancedOptions.angleB?t.advancedOptions.angleB:1,M=t.advancedOptions.speedA?t.advancedOptions.speedA:.15,b=t.advancedOptions.speedB?t.advancedOptions.speedB:.06,S=t.advancedOptions.headColor?t.advancedOptions.headColor:"#4b4b4b",m=t.advancedOptions.headSize?t.advancedOptions.headSize:2,k=t.advancedOptions.tailColor?t.advancedOptions.tailColor:"#4b4b4b",P=t.advancedOptions.tailSize?t.advancedOptions.tailSize:1,I=t.advancedOptions.bodyColor?t.advancedOptions.bodyColor:"#4b4b4b",B=t.advancedOptions.bodyStrokeWidth?t.advancedOptions.bodyStrokeWidth:1,A=t.advancedOptions.distMin?t.advancedOptions.distMin:1,R=t.advancedOptions.distMax?t.advancedOptions.distMax:4}function l(){T=spinners.particleFactory(2,h,p,g,0,!1,null,null,null)}function r(){u.clearRect(0,0,h,p),s(),c(),requestAnimationFrame(r)}function s(){var t=v-f,n=y-x;"tail"===W?(f+=M,v+=b,y+=b,x+=M,t<A&&(W="pauseHead")):"head"===W?(f+=b,v+=M,y+=M,x+=b,t>R&&(W="pauseTail")):"pauseTail"===W?(f+=b,v+=b,y+=M,x+=b,n>=2*Math.PI&&(W="tail",y=v)):"pauseHead"===W&&(f+=b,v+=b,y+=b,x+=M,n<=0&&(W="head",x=f))}function c(){u.save(),u.beginPath(),u.arc(h/2,p/2,g,f,v,!1),u.lineWidth=B,u.strokeStyle=I,u.globalAlpha=w,u.stroke();for(var t=0;t<T.length;t++)u.beginPath(),u.arc(T[0].x=h/2+Math.cos(f)*g,T[t].y=p/2+Math.sin(f)*g,P,0,2*Math.PI,!1),u.fillStyle=k,u.globalAlpha=w,u.fill(),u.beginPath(),u.arc(T[1].x=h/2+Math.cos(v)*g,T[1].y=p/2+Math.sin(v)*g,m,0,2*Math.PI,!1),u.fillStyle=S,u.globalAlpha=w,u.fill();u.restore()}var d=null,u=null,h=null,p=null,g=null,f=null,v=null,y=1,x=0,M=null,b=null,S=null,m=null,k=null,P=null,I=null,B=null,A=null,R=null,O=null,C=null,w=null,W="head",T=[],F=null;return n(t),{init:n}}function ClockSpinner(t){function n(t){e(t),a(t),o(t),l()}function e(t){var n=document.getElementById(t.setup.containerId);s=document.getElementById(t.setup.canvasId),c=s.getContext("2d"),i(n)}function i(t){var n=window.devicePixelRatio||1,e=c.webkitBackingStorePixelRatio||c.mozBackingStorePixelRatio||c.msBackingStorePixelRatio||c.oBackingStorePixelRatio||c.backingStorePixelRatio||1;A=n/e,d=s.width=t.offsetWidth*A,u=s.height=t.offsetHeight*A,s.style.width=d/A+"px",s.style.height=u/A+"px"}function a(t){h=t.options.radius?t.options.radius:15,p=t.options.speed?t.options.speed:.1,g=p/12,I=t.options.direction?t.options.direction:"right",B=t.options.opacity?t.options.opacity:1}function o(t){f=t.advancedOptions.startAngleMinutes?t.advancedOptions.startAngleMinutes:0,v=t.advancedOptions.startAngleHours?t.advancedOptions.startAngleHours:0,y=t.advancedOptions.armWidthMinute?t.advancedOptions.armWidthMinute:1,x=t.advancedOptions.armWidthHour?t.advancedOptions.armWidthHour:2,M=t.advancedOptions.clockLineWidth?t.advancedOptions.clockLineWidth:1,b=t.advancedOptions.armColorMinute?t.advancedOptions.armColorMinute:"#4b4b4b",S=t.advancedOptions.armColorHour?t.advancedOptions.armColorHour:"#4b4b4b",m=t.advancedOptions.clockColorLine?t.advancedOptions.clockColorLine:"#4b4b4b",k=t.advancedOptions.clockColorFill?t.advancedOptions.clockColorFill:"#ffffff",P=t.advancedOptions.indicatorColorFill?t.advancedOptions.indicatorColorFill:"#4b4b4b",t.advancedOptions.hoursIndicator&&(R=spinners.particleFactory(12,d,u,h/1.2,0,!1,null,null,null))}function l(){c.clearRect(0,0,d,u),r(),requestAnimationFrame(l)}function r(){c.save(),c.globalAlpha=B,c.beginPath(),c.arc(d/2,u/2,h,0,2*Math.PI,!1),c.strokeStyle=m,c.lineWidth=M,c.fillStyle=k,c.globalAlpha=B,c.fill(),c.stroke();for(var t=0;t<R.length;t++)c.beginPath(),c.arc(R[t].x,R[t].y,1,0,2*Math.PI,!1),c.fillStyle=P,c.fill();c.beginPath(),c.moveTo(d/2,u/2),c.lineTo(d/2+Math.cos(v)*(h/2),u/2+Math.sin(v)*(h/2)),c.strokeStyle=S,c.lineWidth=x,c.stroke(),c.beginPath(),c.moveTo(d/2,u/2),c.lineTo(d/2+Math.cos(v)*-(h/4),u/2+Math.sin(v)*-(h/4)),c.strokeStyle=S,c.lineWidth=x,c.stroke(),c.beginPath(),c.moveTo(d/2,u/2),c.lineTo(d/2+Math.cos(f)*(h/1.3),u/2+Math.sin(f)*(h/1.3)),c.strokeStyle=b,c.lineWidth=y,c.stroke(),c.beginPath(),c.moveTo(d/2,u/2),c.lineTo(d/2+Math.cos(f)*-(h/3),u/2+Math.sin(f)*-(h/3)),c.strokeStyle=b,c.lineWidth=y,c.stroke(),"right"===I?(f+=p,v+=g):"left"===I&&(f-=p,v-=g),c.restore()}var s=null,c=null,d=null,u=null,h=null,p=null,g=null,f=null,v=null,y=null,x=null,M=null,b=null,S=null,m=null,k=null,P=null,I=null,B=null,A=null,R=[];return n(t),{init:n}}function GearSpinner(t){function n(t){e(t),a(t),o(t),l(),r()}function e(t){var n=document.getElementById(t.setup.containerId);c=document.getElementById(t.setup.canvasId),d=c.getContext("2d"),i(n)}function i(t){var n=window.devicePixelRatio||1,e=d.webkitBackingStorePixelRatio||d.mozBackingStorePixelRatio||d.msBackingStorePixelRatio||d.oBackingStorePixelRatio||d.backingStorePixelRatio||1;I=n/e,u=c.width=t.offsetWidth*I,h=c.height=t.offsetHeight*I,c.style.width=u/I+"px",c.style.height=h/I+"px"}function a(t){b=t.options.color?t.options.color:"#4b4b4b",v=t.options.speed?t.options.speed:.06,S=t.options.direction?t.options.direction:"right",m=t.options.opacity?t.options.opacity:1}function o(t){f=t.advancedOptions.teeth?t.advancedOptions.teeth:16,p=t.options.radius?t.options.radius:40,g=p-p/5,y=g/2}function l(){k=spinners.particleFactory(f,u,h,p,Math.PI/f,!1,null,null,null),P=spinners.particleFactory(f,u,h,g,Math.PI/f,!1,null,null,null)}function r(){d.clearRect(0,0,u,h),s(),requestAnimationFrame(r)}function s(){d.save(),d.globalAlpha=m;for(var t=0;t<f;t++)d.beginPath(),d.fillStyle=b,t%2!==0&&(d.moveTo(P[t].x=u/2+Math.cos(P[t].angleStart+x)*g,P[t].y=h/2+Math.sin(P[t].angleStart+x)*g),d.lineTo(P[t-1].x=u/2+Math.cos(P[t-1].angleStart-x)*g,P[t-1].y=h/2+Math.sin(P[t-1].angleStart-x)*g),d.lineTo(k[t-1].x=u/2+Math.cos(k[t-1].angleStart+M)*p,k[t-1].y=h/2+Math.sin(k[t-1].angleStart+M)*p),d.lineTo(k[t].x=u/2+Math.cos(k[t].angleStart-M)*p,k[t].y=h/2+Math.sin(k[t].angleStart-M)*p),d.lineTo(P[t].x=u/2+Math.cos(P[t].angleStart+x)*g,P[t].y=h/2+Math.sin(P[t].angleStart+x)*g)),d.fill(),"right"===S?(k[t].angleStart+=v,P[t].angleStart+=v):"left"===S&&(k[t].angleStart-=v,P[t].angleStart-=v);d.beginPath(),d.arc(u/2,h/2,g-y/2,0,2*Math.PI,!1),d.strokeStyle=b,d.lineWidth=y,d.stroke(),d.restore()}var c=null,d=null,u=null,h=null,p=null,g=null,f=null,v=null,y=null,x=.1,M=.1,b=null,S=null,m=null,k=[],P=[],I=null;n(t)}function Tailspinner(t){function n(t){e(t),a(t),o(t),l(),d()}function e(t){var n=document.getElementById(t.setup.containerId);p=document.getElementById(t.setup.canvasId),g=p.getContext("2d"),i(n)}function i(t){var n=window.devicePixelRatio||1,e=g.webkitBackingStorePixelRatio||g.mozBackingStorePixelRatio||g.msBackingStorePixelRatio||g.oBackingStorePixelRatio||g.backingStorePixelRatio||1;w=n/e,f=p.width=t.offsetWidth*w,v=p.height=t.offsetHeight*w,p.style.width=f/w+"px",p.style.height=v/w+"px"}function a(t){y=t.options.radius?t.options.radius:15,m=t.options.speed?t.options.speed:.1,M=t.options.color?t.options.color:"#4b4b4b",b=t.options.direction?t.options.direction:"right",S=t.options.opacity?t.options.opacity:1}function o(t){P=t.advancedOptions.particleSize?t.advancedOptions.particleSize:4,k=t.advancedOptions.shrinkValue?t.advancedOptions.shrinkValue:.05,R=t.advancedOptions.fadeoutValue?t.advancedOptions.fadeoutValue:.05,O=t.advancedOptions.particles?t.advancedOptions.particles:40,I=!!t.advancedOptions.backgroundStroke&&t.advancedOptions.backgroundStroke,B=t.advancedOptions.backgroundStrokeColor?t.advancedOptions.backgroundStrokeColor:"#ffffff",A=t.advancedOptions.backgroundStrokeWidth?t.advancedOptions.backgroundStrokeWidth:12}function l(){C=spinners.particleFactory(O,f,v,y,0,!1,null,null,null),s(),r(),c()}function r(){for(var t=P,n=0;n<C.length;n++)C[n].size=t,t-=k}function s(){for(var t=1,n=0;n<C.length;n++)C[n].opacity=t,t-=R}function c(){for(var t=x,n=0;n<C.length;n++)C[n].position=t,t-=k}function d(){g.clearRect(0,0,f,v),h(),u(),requestAnimationFrame(d)}function u(){for(var t=0;t<C.length;t++)"right"===b?C[t].position+=m:"left"===b&&(C[t].position-=m)}function h(){g.save(),I===!0&&(g.beginPath(),g.arc(f/2,v/2,y,0,2*Math.PI,!1),g.strokeStyle=B,g.lineWidth=A,g.stroke());for(var t=0;t<C.length;t++)g.beginPath(),g.arc(C[t].x=f/2+Math.cos(C[t].position)*y,C[t].y=v/2+Math.sin(C[t].position)*y,C[t].size,0,2*Math.PI,!1),g.globalAlpha=C[t].opacity,g.fillStyle=M,g.fill();g.restore()}var p=null,g=null,f=null,v=null,y=null,x=0,M=null,b=null,S=null,m=null,k=null,P=null,I=null,B=null,A=null,R=null,O=null,C=[],w=null;n(t)}var spinners=function(){function t(t){switch(t.spinner){case"theCircle":theCircle.init(t);break;case"theTail":theTail.init(t);break;case"star":theExperiments.init(t);break;case"wormII":theMultiLayer.init(t);break;case"worm":theWorm.init(t);break;case"drop":theGravity.init(t);break;case"theWeirdSpoke":theWeirdSpoke.init(t);break;case"theWatch":theWatch.init(t);break;case"catchUpSpinnerII":theCatchupExperiment.init(t);break;case"theGear":theGear.init(t)}}function n(t,n,e,i,a,o,l,r,s){for(var c=a?a:0,d=[],u=0;u<t;u++){var h=particle.create(n/2+Math.cos(c)*i,e/2+Math.sin(c)*i,0,0,0),p=particle.create(n/2,e/2,0,0,0);o&&(h.friction=l,h.addSpring(p,r,s)),h.angleStart=c,c+=Math.PI/(t/2),h.angleStop=c,h.arcX=h.x,h.arcY=h.y,d.push(h)}return d}return{init:t,particleFactory:n}}(),theCatchupExperiment=function(){function t(t){var e=document.getElementById(t.containerId);i=document.getElementById(t.canvasId),a=i.getContext("2d"),o=i.width=e.offsetWidth,l=i.height=e.offsetHeight,h=t.speedA?t.speedA:.1,p=t.speedB?t.speedB:.04,f=t.myColor?t.myColor:"#4b4b4b",v=t.myArcRadius?t.myArcRadius:20,y=t.myLineWidth?t.myLineWidth:3,x=spinners.particleFactory(5,o,l,v,0,!1,null,null,null),n()}function n(){a.clearRect(0,0,o,l),e(),requestAnimationFrame(n)}function e(){a.save(),"startAngleB"===g?(r+=p,s+=p,c+=h,d+=p,utils.distanceXY(x[2].x,x[2].y,x[3].x,x[3].y)<3&&(g="pauseBA")):"stopAngleA"===g?(r+=p,s+=h,c+=p-.01,d+=p,utils.distanceXY(x[1].x,x[1].y,x[2].x,x[2].y)<3&&(g="pauseAA")):"startAngleA"===g?(r+=h,s+=p,c+=p,d+=p,utils.distanceXY(x[0].x,x[0].y,x[1].x,x[1].y)<3&&(g="pauseAB")):"stopAngleB"===g?(r+=p-.02,s+=p,c+=p,d+=h,utils.distanceXY(x[0].x,x[0].y,x[3].x,x[3].y)<3&&(g="pauseBB")):"pauseBB"===g?(r+=p,s+=p,c+=p+.02,d+=p,utils.distanceXY(x[2].x,x[2].y,x[4].x,x[4].y)<2&&(g="startAngleB")):"pauseBA"===g?(r+=p,s+=.01,s+=p+.01,c+=p,d+=p,utils.distanceXY(x[1].x,x[1].y,x[4].x,x[4].y)<2&&(g="stopAngleA")):"pauseAA"===g?(r+=p+.01,s+=p,c+=p,d+=p+.01,utils.distanceXY(x[0].x,x[0].y,x[4].x,x[4].y)<2&&(g="startAngleA")):"pauseAB"===g&&(r+=p,s+=p,c+=p,d+=p+.03,utils.distanceXY(x[3].x,x[3].y,x[4].x,x[4].y)<2&&(g="stopAngleB")),a.beginPath(),a.arc(o/2,l/2,v,r,s,!1),a.lineWidth=y,a.strokeStyle="green",a.strokeStyle=f,a.stroke(),a.beginPath(),a.arc(o/2,l/2,v,c,d+1,!1),a.lineWidth=y,a.strokeStyle="red",a.strokeStyle=f,a.stroke();for(var t=0;t<x.length;t++)a.beginPath(),a.arc(x[0].x=o/2+Math.cos(r)*v,x[0].y=l/2+Math.sin(r)*v,y/2-.2,0,2*Math.PI,!1),a.fillStyle=f,a.fill(),a.beginPath(),a.arc(x[1].x=o/2+Math.cos(s)*v,x[1].y=l/2+Math.sin(s)*v,y/2-.2,0,2*Math.PI,!1),a.fillStyle=f,a.fill(),a.beginPath(),a.arc(x[2].x=o/2+Math.cos(c)*v,x[2].y=l/2+Math.sin(c)*v,y/2-.2,0,2*Math.PI,!1),a.fillStyle=f,a.fill(),a.beginPath(),a.arc(x[3].x=o/2+Math.cos(d+1)*v,x[3].y=l/2+Math.sin(d+1)*v,y/2-.2,0,2*Math.PI,!1),a.fillStyle=f,a.fill(),a.beginPath(),a.arc(x[4].x=o/2+Math.cos(u)*v,x[4].y=l/2+Math.sin(u)*v,2,0,2*Math.PI,!1),a.globalAlpha=0,a.fillStyle="#ff0000",a.fill();a.beginPath(),a.moveTo(o/2,l/2),a.lineTo(o/2+Math.cos(u)*v,l/2+Math.sin(u)*v),a.lineWidth=.2,a.stroke(),u+=h,a.restore()}var i=null,a=null,o=null,l=null,r=0,s=1,c=1,d=1,u=2,h=.1,p=.04,g="stopAngleB",f=null,v=20,y=3,x=[];return{init:t}}(),theExperiments=function(){function t(t){var e=document.getElementById(t.containerId);i=document.getElementById(t.canvasId),a=i.getContext("2d"),o=i.width=e.offsetWidth,l=i.height=e.offsetHeight,p=spinners.particleFactory(c,o,l,r,0,!1,null,null,null),g=spinners.particleFactory(c,o,l,s,Math.PI/c,!1,null,null,null),n()}function n(){a.clearRect(0,0,o,l),e(),requestAnimationFrame(n)}function e(){a.save();for(var t=0;t<c;t++)a.beginPath(),a.moveTo(p[t].x=o/2+Math.cos(p[t].angleStart)*r,p[t].y=l/2+Math.sin(p[t].angleStart)*r),a.lineTo(g[t].x=o/2+Math.cos(g[t].angleStart)*s,g[t].y=l/2+Math.sin(g[t].angleStart)*s),t<c-1?a.lineTo(p[t+1].x,p[t+1].y):(a.moveTo(g[c-1].x,g[c-1].y),a.lineTo(p[0].x,p[0].y)),a.strokeStyle="#4b4b4b",a.stroke(),p[t].angleStart+=d,g[t].angleStart+=d,"shrink"===h?(s-=u,s<=r-8&&(h="grow")):"grow"===h&&(s+=u,s>=r+8&&(h="shrink"));a.restore()}var i=null,a=null,o=null,l=null,r=20,s=r+8,c=8,d=.03,u=.01,h="shrink",p=[],g=[];return{init:t}}(),theGravity=function(){function t(t){var e=document.getElementById(t.containerId);i=document.getElementById(t.canvasId),a=i.getContext("2d"),o=i.width=e.offsetWidth,l=i.height=e.offsetHeight,d=t.arcRadius?t.arcRadius:20,u=t.lineColor?t.lineColor:"#4b4b4b",h=t.lineWidth?t.lineWidth:1,p=t.dotColor?t.dotColor:"#4b4b4b",g=t.dotSize?t.dotSize:2,f=t.opacity?t.opacity:1,n()}function n(){a.clearRect(0,0,o,l),e(),requestAnimationFrame(n)}function e(){a.save(),a.beginPath(),a.arc(o/2+Math.cos(r)*d,l/2+Math.sin(r)*d,g,0,2*Math.PI,!1),a.fillStyle=p,a.globalAlpha=f,a.fill(),a.beginPath(),a.arc(o/2,l/2,d,0,2*Math.PI,!1),a.lineWidth=h,a.strokeStyle=u,a.stroke(),r>=1.5*Math.PI?s+=c:r>=0&&r<=.5*Math.PI?s+=c:s-=1.05*c,r>2*Math.PI&&(r=0),r+=s,a.restore()}var i=null,a=null,o=null,l=null,r=1.5*Math.PI,s=.02,c=.01,d=null,u=null,h=null,p=null,g=null,f=null;return{init:t}}(),theMultiLayer=function(){function t(t){var a=document.getElementById(t.containerId);o=document.getElementById(t.canvasId),l=o.getContext("2d"),n(a),h=t,c=t.layers,u=e(t),i()}function n(t){var n=window.devicePixelRatio||1,e=l.webkitBackingStorePixelRatio||l.mozBackingStorePixelRatio||l.msBackingStorePixelRatio||l.oBackingStorePixelRatio||l.backingStorePixelRatio||1,i=n/e;r=o.width=t.offsetWidth*i,s=o.height=t.offsetHeight*i,o.style.width=r/i+"px",o.style.height=s/i+"px"}function e(t){for(var n=[],e=t.arcRadiusOffset,i=0;i<t.layers;i++){var a={angleA:0,angleB:1,speedA:.1,speedB:.02,headColor:t.template.headColor,headSize:3,tailColor:t.template.tailColor,tailSize:2,bodyColor:t.template.bodyColor,bodyStrokeWidth:1,distMin:1,distMax:4,arcRadius:e,pSize:1,pHead:spinners.particleFactory(1,r,s,e,0,!1,null,null,null),pTail:spinners.particleFactory(1,r,s,e,0,!1,null,null,null)};n.push(a),e-=t.layersDistance}return n}function i(){l.clearRect(0,0,r,s),a(),requestAnimationFrame(i)}function a(){l.save();for(var t=0;t<c;t++)l.beginPath(),l.arc(u[t].pHead[0].x=r/2+Math.cos(h.angleA)*u[t].arcRadius,u[t].pHead[0].x=s/2+Math.sin(h.angleA)*u[t].arcRadius,.5,0,2*Math.PI,!1),l.arc(u[t].pTail[0].x=r/2+Math.cos(h.angleB)*u[t].arcRadius,u[t].pTail[0].x=s/2+Math.sin(h.angleB)*u[t].arcRadius,.5,0,2*Math.PI,!1),l.fillStyle="#4b4b4b",l.fill(),l.beginPath(),l.arc(r/2,s/2,u[t].arcRadius,h.angleA,h.angleB,!1),l.strokeStyle="#4b4b4b",l.lineWidth=h.lineWidth,l.stroke();var n=h.angleB-h.angleA;"tail"===d?(h.angleA+=h.speedA,h.angleB+=h.speedB,n<h.distMin&&(d="head")):"head"===d&&(h.angleA+=h.speedB,h.angleB+=h.speedA,n>h.distMax&&(d="tail")),l.restore()}var o=null,l=null,r=null,s=null,c=null,d="head",u=[],h=null;return{init:t}}(),theWeirdSpoke=function(){function t(t){var i=document.getElementById(t.containerId);a=document.getElementById(t.canvasId),o=a.getContext("2d"),l=a.width=i.offsetWidth,r=a.height=i.offsetHeight,n(48),e()}function n(t){for(var n=0,e=0;e<t;e++){var i=particle.create(l/2+Math.cos(n)*s,r/2+Math.sin(n)*s,0,0,0),a=particle.create(l/2,r/2,0,0,0);i.friction=u,i.angleStart=n,i.addSpring(a,c,d),n+=Math.PI/(t/2),i.angleStop=n,g.push(i)}}function e(){o.clearRect(0,0,l,r),i(),requestAnimationFrame(e)}function i(){o.save();for(var t=0;t<g.length;t++)o.beginPath(),o.arc(g[t].x,g[t].y,1,0,2*Math.PI,!1),o.lineTo(g[t].x,g[t].y),p>g[t].angleStart&&p<g[t].angleStop?(isNaN(g[t].x)||o.moveTo(g[t].x=l/2+Math.cos(g[t].angleStop),g[t].y=r/2+Math.sin(g[t].angleStop)),o.fillStyle="#ff0000"):o.fillStyle="#666666",o.fill(),g[t].update();p+=h,p>2*Math.PI&&(p=0),o.restore()}var a=null,o=null,l=null,r=null,s=30,c=.1,d=10,u=.25,h=.08,p=0,g=[];return{init:t}}(),theWorm=function(){function t(t){var a=document.getElementById(t.containerId);o=document.getElementById(t.canvasId),l=o.getContext("2d"),r=o.width=a.offsetWidth,s=o.height=a.offsetHeight,n(a),e(t),k=spinners.particleFactory(2,r,s,c,0,!1,null,null,null),i()}function n(t){var n=window.devicePixelRatio||1,e=l.webkitBackingStorePixelRatio||l.mozBackingStorePixelRatio||l.msBackingStorePixelRatio||l.oBackingStorePixelRatio||l.backingStorePixelRatio||1;ratio=n/e,r=o.width=t.offsetWidth*ratio,s=o.height=t.offsetHeight*ratio,o.style.width=r/ratio+"px",o.style.height=s/ratio+"px"}function e(t){c=t.arcRadius?t.arcRadius:20,d=t.angleA?t.angleA:0,u=t.angleB?t.angleB:1,h=t.speedA?t.speedA:.15,p=t.speedB?t.speedB:.06,g=t.headColor?t.headColor:"#4b4b4b",f=t.headSize?t.headSize:2,v=t.tailColor?t.tailColor:"#4b4b4b",y=t.tailSize?t.tailSize:1,x=t.bodyColor?t.bodyColor:"#4b4b4b",M=t.bodyStrokeWidth?t.bodyStrokeWidth:1,b=t.distMin?t.distMin:1,S=t.distMax?t.distMax:4}function i(){l.clearRect(0,0,r,s),a(),requestAnimationFrame(i)}function a(){l.save(),l.beginPath(),l.arc(r/2,s/2,c,d,u,!1),l.lineWidth=M,l.strokeStyle=x,l.stroke();for(var t=0;t<k.length;t++)l.beginPath(),l.arc(k[0].x=r/2+Math.cos(d)*c,k[t].y=s/2+Math.sin(d)*c,y,0,2*Math.PI,!1),l.fillStyle=v,l.fill(),l.beginPath(),l.arc(k[1].x=r/2+Math.cos(u)*c,k[1].y=s/2+Math.sin(u)*c,f,0,2*Math.PI,!1),l.fillStyle=g,l.fill();var n=u-d;"tail"===m?(d+=h,u+=p,n<b&&(m="head")):"head"===m&&(d+=p,u+=h,n>S&&(m="tail")),l.restore()}var o=null,l=null,r=null,s=null,c=null,d=null,u=null,h=null,p=null,g=null,f=null,v=null,y=null,x=null,M=null,b=null,S=null,m="head",k=[];return{init:t}}(),particle={x:0,y:0,vx:0,vy:0,mass:1,radius:0,bounce:-1,friction:1,gravity:0,springs:null,gravitation:null,create:function(t,n,e,i,a){var o=Object.create(this);return o.x=t,o.y=n,o.vx=Math.cos(i)*e,o.vy=Math.sin(i)*e,o.gravity=a||0,o.springs=[],o.gravitation=[],o},addGravitation:function(t){this.removeGravitation(t),this.gravitation.push(t)},removeGravitation:function(t){for(var n=0;n<this.gravitation.length;n+=1)if(t===this.gravitation[n])return void this.gravitation.splice(n,1)},addSpring:function(t,n,e){this.removeSpring(t),this.springs.push({point:t,k:n,length:e||0})},removeSpring:function(t){for(var n=0;n<this.springs.length;n+=1)if(t===this.springs[n].point)return void this.springs.splice(n,1)},getSpeed:function(){return Math.sqrt(this.vx*this.vx+this.vy*this.vy)},setSpeed:function(t){var n=this.getHeading();this.vx=Math.cos(n)*t,this.vy=Math.sin(n)*t},getHeading:function(){return Math.atan2(this.vy,this.vx)},setHeading:function(t){var n=this.getSpeed();this.vx=Math.cos(t)*n,this.vy=Math.sin(t)*n},accelerate:function(t,n){this.vx+=t,this.vy+=n},update:function(){this.handleSprings(),this.handlegravitation(),this.vx*=this.friction,this.vy*=this.friction,this.vy+=this.gravity,this.x+=this.vx,this.y+=this.vy},handlegravitation:function(){for(var t=0;t<this.gravitation.length;t+=1)this.gravitateTo(this.gravitation[t])},handleSprings:function(){for(var t=0;t<this.springs.length;t+=1){var n=this.springs[t];this.springTo(n.point,n.k,n.length)}},angleTo:function(t){return Math.atan2(t.y-this.y,t.x-this.x)},distanceTo:function(t){var n=t.x-this.x,e=t.y-this.y;return Math.sqrt(n*n+e*e)},gravitateTo:function(t){var n=t.x-this.x,e=t.y-this.y,i=n*n+e*e,a=Math.sqrt(i),o=t.mass/i,l=n/a*o,r=e/a*o;this.vx+=l,this.vy+=r},springTo:function(t,n,e){var i=t.x-this.x,a=t.y-this.y,o=Math.sqrt(i*i+a*a),l=(o-e||0)*n;this.vx+=i/o*l,this.vy+=a/o*l}},utils={norm:function(t,n,e){return(t-n)/(e-n)},lerp:function(t,n,e){return(e-n)*t+n},map:function(t,n,e,i,a){return utils.lerp(utils.norm(t,n,e),i,a)},clamp:function(t,n,e){return Math.min(Math.max(t,Math.min(n,e)),Math.max(n,e))},distance:function(t,n){var e=n.x-t.x,i=n.y-t.y;return Math.sqrt(e*e+i*i)},distanceXY:function(t,n,e,i){var a=e-t,o=i-n;return Math.sqrt(a*a+o*o)},circleCollision:function(t,n){return utils.distance(t,n)<=t.radius+n.radius},circlePointCollision:function(t,n,e){return utils.distanceXY(t,n,e.x,e.y)<e.radius},pointInRect:function(t,n,e){return utils.inRange(t,e.x,e.x+e.width)&&utils.inRange(n,e.y,e.y+e.height)},inRange:function(t,n,e){return t>=Math.min(n,e)&&t<=Math.max(n,e)},rangeIntersect:function(t,n,e,i){return Math.max(t,n)>=Math.min(e,i)&&Math.min(t,n)<=Math.max(e,i)},rectIntersect:function(t,n){return utils.rangeIntersect(t.x,t.x+t.width,n.x,n.x+n.width)&&utils.rangeIntersect(t.y,t.y+t.height,n.y,n.y+n.height)},degreesToRads:function(t){return t/180*Math.PI},radsToDegrees:function(t){return 180*t/Math.PI},randomRange:function(t,n){return t+Math.random()*(n-t)},randomInt:function(t,n){return Math.floor(t+Math.random()*(n-t+1))},roundToPlaces:function(t,n){var e=Math.pow(10,n);return Math.round(t*e)/e},roundNearest:function(t,n){return Math.round(t/n)*n},quadraticBezier:function(t,n,e,i,a){return a=a||{},a.x=Math.pow(1-i,2)*t.x+2*(1-i)*i*n.x+i*i*e.x,a.y=Math.pow(1-i,2)*t.y+2*(1-i)*i*n.y+i*i*e.y,a},cubicBezier:function(t,n,e,i,a,o){return o=o||{},o.x=Math.pow(1-a,3)*t.x+3*Math.pow(1-a,2)*a*n.x+3*(1-a)*a*a*e.x+a*a*a*i.x,o.y=Math.pow(1-a,3)*t.y+3*Math.pow(1-a,2)*a*n.y+3*(1-a)*a*a*e.y+a*a*a*i.y,o},multicurve:function(t,n){var e,i,a,o;n.moveTo(t[0].x,t[0].y);for(var l=1;l<t.length-2;l+=1)e=t[l],i=t[l+1],a=(e.x+i.x)/2,o=(e.y+i.y)/2,n.quadraticCurveTo(e.x,e.y,a,o);e=t[t.length-2],i=t[t.length-1],n.quadraticCurveTo(e.x,e.y,i.x,i.y)}};